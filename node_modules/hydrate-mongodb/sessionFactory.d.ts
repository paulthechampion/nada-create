import { Collection, MongoClient } from "mongodb";
import { Table } from "./core/table";
import { MappingRegistry } from "./mapping/mappingRegistry";
import { Session, InternalSession } from "./session";
import { Constructor } from "./index";
import { Persister } from "./persister";
import { EntityMapping } from "./mapping/entityMapping";
import { Logger } from "./config/configuration";
import { Callback } from "./core/callback";
export interface SessionFactory {
    /**
     * The MongoDB database connection associated with this [SessionFactory].
     */
    connection: MongoClient;
    /**
     * Gets the MongoDB database collection for the specified Entity constructor.
     * @param ctr The constructor to get the collection for.
     */
    getCollection(ctr: Constructor<any>): Collection;
    /**
     * Creates a new database session.
     */
    createSession(): Session;
    /**
     * Creates any indexes, defined on the mappings, that do not already exist.
     * @param callback Called after the operation has completed.
     */
    createIndexes(callback: Callback): void;
    /**
     * Creates any indexes, defined on the mappings, that do not already exist.
     * @param options Options for creating indexes.
     * @param callback Called after the operation has completed.
     */
    createIndexes(options: CreateIndexesOptions, callback: Callback): void;
    /**
     * Drops all indexes for all collections managed by Hydrate. This includes indexes that were not created by Hydrate.
     * @param callback Called after the operation has completed.
     */
    dropIndexes(callback: Callback): void;
}
/**
 * Options for creating indexes.
 */
export interface CreateIndexesOptions {
    /**
     * If specified, indexes are created in the background; otherwise, the database is locked while indexes are created.
     */
    background?: boolean;
}
/**
 * @hidden
 */
export interface InternalSessionFactory extends SessionFactory {
    logger: Logger;
    getMappingForObject(obj: any): EntityMapping;
    getMappingForConstructor(ctr: Constructor<any>): EntityMapping;
    createPersister(session: InternalSession, mapping: EntityMapping): Persister;
}
/**
 * @hidden
 */
export declare class SessionFactoryImpl implements InternalSessionFactory {
    connection: MongoClient;
    logger: Logger;
    private _collections;
    private _mappingRegistry;
    constructor(connection: MongoClient, collections: Table<Collection>, mappingRegistry: MappingRegistry);
    createSession(): Session;
    getCollection(ctr: Constructor<any>): Collection;
    getMappingForObject(obj: any): EntityMapping;
    getMappingForConstructor(ctr: Constructor<any>): EntityMapping;
    createPersister(session: InternalSession, mapping: EntityMapping): Persister;
    createIndexes(callback: Callback): void;
    createIndexes(options: CreateIndexesOptions, callback: Callback): void;
    /**
     * Drops all indexes for all collections managed by Hydrate. This includes indexes that were not created by Hydrate.
     * @param callback Called after the operation has completed.
     */
    dropIndexes(callback: Callback): void;
}
